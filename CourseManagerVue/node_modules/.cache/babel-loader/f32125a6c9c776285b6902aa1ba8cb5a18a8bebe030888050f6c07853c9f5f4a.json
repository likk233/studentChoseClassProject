{"ast":null,"code":"import \"core-js/modules/es.error.cause.js\";\nimport \"core-js/modules/es.array.push.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport Config from \"./config\";\nimport axios from \"axios\";\nimport { ElMessage } from \"element-plus\";\nexport var vueInstance = {\n  store: null,\n  router: null\n};\nvar runningRequest = 0;\nfunction addRequestCount() {\n  runningRequest++;\n  if (runningRequest > 0 && vueInstance.store != null) {\n    vueInstance.store.state.loading = true;\n  }\n}\nfunction subtractRequestCount() {\n  runningRequest--;\n  if (runningRequest <= 0 && vueInstance.store != null) {\n    vueInstance.store.state.loading = false;\n  }\n}\nfunction innerMessage(type, message) {\n  ElMessage({\n    showClose: true,\n    duration: 2000,\n    message: message,\n    type: type\n  });\n}\nvar axiosInstance = axios.create({\n  baseURL: Config.backEndUrl,\n  timeout: 30000,\n  withCredentials: true\n});\naxiosInstance.interceptors.response.use(function (response) {\n  if (response.data == undefined) {\n    return response.data;\n  }\n  var data = response.data.data;\n  subtractRequestCount();\n  return data;\n}, function (error) {\n  if (error.response == undefined) {\n    return Promise.reject(new Error(\"Network Error\"));\n  }\n  var code = error.response.data.code;\n  var message = error.response.data.message;\n  var data = error.response.data.data;\n  subtractRequestCount();\n  if (code === -1) {\n    innerMessage(\"info\", \"需要登录\");\n    setTimeout(function () {\n      return window.location.href = \"/login\";\n    }, 250);\n    return Promise.reject(new Error(\"NO_LOGIN\"));\n  } else if (code === 1) {\n    innerMessage(\"error\", \"错误: \" + message);\n    return Promise.reject(new Error(\"FAIL\"));\n  } else if (code === 2) {\n    innerMessage(\"info\", \"您不是此角色\");\n    setTimeout(function () {\n      return window.location.href = \"/login\";\n    }, 250);\n    return Promise.reject(new Error(\"ERROR_ROLE\"));\n  } else if (code === 3) {\n    innerMessage(\"info\", \"您没有此权限\");\n    setTimeout(function () {\n      return window.location.href = \"/login\";\n    }, 250);\n    return Promise.reject(new Error(\"NO_PERMISSION\"));\n  } else if (code === 4) {\n    var errorMessage = \"请求参数错误\";\n    if (data.length > 0) {\n      errorMessage = \"参数错误: \" + data[0].message;\n    }\n    innerMessage(\"error\", errorMessage);\n    return Promise.reject(new Error(\"INVALID_PARAMETER\"));\n  } else if (code === 10) {\n    innerMessage(\"error\", \"内部服务器错误\");\n    return Promise.reject(new Error(\"INTERNAL_SERVER_ERROR\"));\n  }\n  if (typeof error.response === \"undefined\") {\n    innerMessage(\"error\", \"与后端服务器通信失败\");\n    if (vueInstance.router) {\n      vueInstance.router.push({\n        name: \"login\"\n      });\n    } else {\n      window.location.href = \"/login\";\n    }\n  } else if (error.response.status >= 400) {\n    innerMessage(\"error\", \"服务器异常\");\n  }\n  return Promise.reject(error);\n});\nvar dataHandle = function dataHandle(response) {\n  return response;\n};\nvar innerGet = function innerGet() {\n  addRequestCount();\n  return axiosInstance.get.apply(this, arguments).then(dataHandle);\n};\nvar innerPost = function innerPost() {\n  addRequestCount();\n  return axiosInstance.post.apply(this, arguments).then(dataHandle);\n};\nvar innerDelete = function innerDelete() {\n  addRequestCount();\n  return axiosInstance.delete.apply(this, arguments).then(dataHandle);\n};\nvar innerPut = function innerPut() {\n  addRequestCount();\n  return axiosInstance.put.apply(this, arguments).then(dataHandle);\n};\nexport var pureGet = function pureGet(url) {\n  return innerGet(url);\n};\nexport var pureDelete = function pureDelete(url) {\n  return innerDelete(url);\n};\nexport var get = function get(url, params) {\n  return innerGet(url, {\n    params: params\n  });\n};\nexport var post = function post(url, data) {\n  return innerPost(url, data, {\n    headers: {\n      \"Content-Type\": \"application/json\"\n    }\n  });\n};\nexport var del = function del(url, params) {\n  return innerDelete(url, {\n    params: params\n  });\n};\nexport var put = function put(url, data) {\n  return innerPut(url, data, {\n    headers: {\n      \"Content-Type\": \"application/json\"\n    }\n  });\n};","map":{"version":3,"names":["Config","axios","ElMessage","vueInstance","store","router","runningRequest","addRequestCount","state","loading","subtractRequestCount","innerMessage","type","message","showClose","duration","axiosInstance","create","baseURL","backEndUrl","timeout","withCredentials","interceptors","response","use","data","undefined","error","Promise","reject","Error","code","setTimeout","window","location","href","errorMessage","length","push","name","status","dataHandle","innerGet","get","apply","arguments","then","innerPost","post","innerDelete","delete","innerPut","put","pureGet","url","pureDelete","params","headers","del"],"sources":["/Users/lizi/Documents/GitHub/lib/studentChoseClassProject/CourseManagerVue/src/common/ajax.js"],"sourcesContent":["import Config from \"./config\";\nimport axios from \"axios\";\nimport { ElMessage } from \"element-plus\";\n\nexport const vueInstance = {\n  store: null,\n  router: null\n};\n\nlet runningRequest = 0;\n\nfunction addRequestCount() {\n  runningRequest++;\n  if (runningRequest > 0 && vueInstance.store != null) {\n    vueInstance.store.state.loading = true;\n  }\n}\n\nfunction subtractRequestCount() {\n  runningRequest--;\n  if (runningRequest <= 0 && vueInstance.store != null) {\n    vueInstance.store.state.loading = false;\n  }\n}\n\nfunction innerMessage(type, message) {\n  ElMessage({\n    showClose: true,\n    duration: 2000,\n    message: message,\n    type: type\n  });\n}\n\nconst axiosInstance = axios.create({\n  baseURL: Config.backEndUrl,\n  timeout: 30000,\n  withCredentials: true\n});\n\naxiosInstance.interceptors.response.use(\n  response => {\n    if(response.data == undefined) {\n      return response.data\n    }\n    let data = response.data.data;\n    subtractRequestCount();\n    return data;\n  },\n  error => {\n    if(error.response == undefined) {\n      return Promise.reject(new Error(\"Network Error\"));\n    }\n    let code = error.response.data.code;\n    let message = error.response.data.message;\n    let data = error.response.data.data;\n    subtractRequestCount();\n\n    if (code === -1) {\n      innerMessage(\"info\", \"需要登录\");\n      setTimeout(() => (window.location.href = \"/login\"), 250);\n      return Promise.reject(new Error(\"NO_LOGIN\"));\n    } else if (code === 1) {\n      innerMessage(\"error\", \"错误: \" + message);\n      return Promise.reject(new Error(\"FAIL\"));\n    } else if (code === 2) {\n      innerMessage(\"info\", \"您不是此角色\");\n      setTimeout(() => (window.location.href = \"/login\"), 250);\n      return Promise.reject(new Error(\"ERROR_ROLE\"));\n    } else if (code === 3) {\n      innerMessage(\"info\", \"您没有此权限\");\n      setTimeout(() => (window.location.href = \"/login\"), 250);\n      return Promise.reject(new Error(\"NO_PERMISSION\"));\n    } else if (code === 4) {\n      let errorMessage = \"请求参数错误\";\n      if (data.length > 0) {\n        errorMessage = \"参数错误: \" + data[0].message;\n      }\n      innerMessage(\"error\", errorMessage);\n      return Promise.reject(new Error(\"INVALID_PARAMETER\"));\n    } else if (code === 10) {\n      innerMessage(\"error\", \"内部服务器错误\");\n      return Promise.reject(new Error(\"INTERNAL_SERVER_ERROR\"));\n    }\n\n    if (typeof error.response === \"undefined\") {\n      innerMessage(\"error\", \"与后端服务器通信失败\");\n      if (vueInstance.router) {\n        vueInstance.router.push({ name: \"login\" });\n      } else {\n        window.location.href = \"/login\";\n      }\n    } else if (error.response.status >= 400) {\n      innerMessage(\"error\", \"服务器异常\");\n    }\n    return Promise.reject(error);\n  }\n);\n\nconst dataHandle = response => {\n  return response;\n};\n\nconst innerGet = function() {\n  addRequestCount();\n  return axiosInstance.get.apply(this, arguments).then(dataHandle);\n};\n\nconst innerPost = function() {\n  addRequestCount();\n  return axiosInstance.post.apply(this, arguments).then(dataHandle);\n};\n\nconst innerDelete = function() {\n  addRequestCount();\n  return axiosInstance.delete.apply(this, arguments).then(dataHandle);\n};\n\nconst innerPut = function() {\n  addRequestCount();\n  return axiosInstance.put.apply(this, arguments).then(dataHandle);\n};\n\nexport const pureGet = function(url) {\n  return innerGet(url);\n};\n\nexport const pureDelete = function(url) {\n  return innerDelete(url);\n};\n\nexport const get = function(url, params) {\n  return innerGet(url, {\n    params: params\n  });\n};\n\nexport const post = function(url, data) {\n  return innerPost(url, data, {\n    headers: {\n      \"Content-Type\": \"application/json\"\n    }\n  });\n};\nexport const del = function(url, params) {\n  return innerDelete(url, {\n    params: params\n  });\n};\n\nexport const put = function(url, data) {\n  return innerPut(url, data, {\n    headers: {\n      \"Content-Type\": \"application/json\"\n    }\n  });\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}